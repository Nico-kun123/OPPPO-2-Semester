# Вычисление разницы между двумя датами

## Содержание

- [Задание](#Задание)
- [Инструкция по работе](#ИНСТРУКЦИЯПОРАБОТЕ)
  - [Начало работы](#Началоработы)
  - [Скрипты](#Скрипты)
  - [Класс даты](#Классдаты)
  - [Измерение времени работы программы](#Скриптдляизмерениявремениработыпрограммы)
  - [Тесты](#Тесты)
  - [Контракты](#Контрактыдляфункцийиклассов)
- [Примечания](#ПРИМЕЧАНИЯ)

## Задание

На языке JavaScript необходимо написать две функции "count_days()" и "show_string()":

1. Функция "count_days()" имеет 2 параметра: две даты (день, месяц и год). Она вычисляет разницу между этими датами в днях и вызывает функцию "show_string()", куда передаётся вычисленное кол-во дней.
2. Функция "show_string()" принимает на входе вычисленное кол-во дней и возвращает строку, например: "Difference (JS):\t${difference} days have passed!".

Также необходимо:

1. Написать эти функции на языке TypeScript.
2. Сравнить время работы этих функций на языках JavaScript и TypeScript. Можно сгенерировать 1 миллион случайных дат.
3. Написать тесты.
4. Написать контракты для функций и класса.

# ИНСТРУКЦИЯ ПО РАБОТЕ
## Начало работы

Среда разработки: Visual Studio Code (далее "VS Code").

Для начала необходимо клонировать репозиторий с GitHub  в текущую папку. Для этого откройте терминал VS Code и напишите следующую команду:
```npm
git clone https://github.com/Nico-kun123/OPPPO-2-Semester
```
Потом необходимо перейти в созданную папку командой:
```npm
cd OPPPO-2-Semester
```
Далее нужно установить все необходимые библиотеки и фреймворки, которые здесь используются (на основе того, что содержится в файле "package.json"). Для этого напишите в терминале следующую команду:
```npm
npm install
```
Всё установилось и готово к работе!

## Скрипты

Ниже приведён список скриптов у данной работы и их пояснение.

```json
"scripts": {
    "alltests": "jest --watchAll",
    "almostwholeyear": "jest ./tests/almostwholeyear.test.js",
    "entireyear": "jest ./tests/entireyear.test.js",
    "newyear": "jest ./tests/newyear.test.js",
    "randomdate": "jest ./tests/randomdate.test.js",
    "zerodays": "jest ./tests/zerodays.test.js",
    "werk": "ts-node-esm main.js"
  },
```

Скрипты:
1. "alltests". Запускает все тесты из папки "tests" одновременно.
2. "almostwholeyear". Запускает тест "almostwholeyear.test.js" из папки "tests".
3. "entireyear". Запускает тест "entireyear.test.js" из папки "tests".
4. "newyear". Запускает тест "newyear.test.js" из папки "tests".
5. "randomdate". Запускает тест "randomdate.test.js" из папки "tests".
6. "zerodays". Запускает тест "zerodays.test.js" из папки "tests".
7. "werk". Запускает модуль "main.js", в котором происходит вычисление времени работы модулей "days.ts" и "days.js".

Подробнее про тесты для данной работы можно почитать [здесь](#Тесты). Подробнее про скрипт для для измерения времени работы программы можно почитать [здесь](#Скриптдляизмерениявремениработыпрограммы).

Для запуска скрипта нужно прописать в терминале следующую команду:
```npm
npm run *script name*
```
...где "script name" — название скрипта.

## Класс даты

Класс "CustomDate" предназначен для работы с датами и содержит методы для генерации случайной даты, проверки правильности даты и т.п. Файл с классом находится в файле "/help/class.js".

Создать класс можно двумя способами:
```javascript
// генерация абсолютно случайно даты
let firstDate = new CustomDate();
// генерация конкретной даты (1е декабря 2022го года)
let secondDate = new CustomDate(1, 12, 2022, false);
```
Во втором случае нужно обязательно передавать последний параметр "false" для того, чтобы сгенерировать конкретную дату. В первом случае этот параметр по умолчанию равен "true", поэтому в конструктор данного класса никакие параметры передавать не нужно.

У класса "CustomDate" есть следующие методы:
1. Метод "adjustDateIfNeeded()". Рекурсивная функция. Проверяет корректность даты (методами "checkDay()", "checkMonth()" и "checkYear()") и генерирует случайный параметр даты, если она не корректна. Например, если в качестве параметра дня была передана строка, а не число; или если дата получилась 31е февраля, то эта дата не корректная. В этом случае случайно генерируется параметр даты, который был не корректный. Рекурсивный вызов совершается только при не корректном дне у даты.
2. Методы "checkDay()", "checkMonth()" и "checkYear()". Проверяют соответствие параметров даты определённым критериям и возвращают "true", если параметры соответствуют им (параметры даты — это число, месяц — это число от 1 до 12 и т.п.). У "checkDay()" также есть проверка того, что данное кол-во дней допустимо для данных месяца и года (метод "getDaysInMonth()").
3. Методы "randDay()", "randMonth()" и "randYear()". Используются для генерации случайных дня (от 1 до 31), месяца (от 1 до 12) и года (от "MIN_YEAR" до "MAX_YEAR" — это константы. См. [Примечания](#ПРИМЕЧАНИЯ)).
4. Метод "getDaysInMonth()". Получает на входе месяц и год, а возвращает кол-во дней у данного месяца данного года с учётом високосности года (с помощью метода "isLeapYear()").
5. Метод "isLeapYear()". Определяет, является ли год високосным. Возвращает "true", если год високосный, иначе "false".
6. Метод "dateToDays()". Получает на входе день, месяц и год. Переводит год и месяц у даты в дни и возвращает это кол-во дней.

## Скрипт для измерения времени работы программы

Измерения времени работы кода на JavaScript (файл days.js) и TypeScript (файл days.ts) происходят в файле "main.js", для запуска соответствующего скрипта используйте команду:
```npm
npm run werk
```
Здесь даты генерируются парами. Количество этих пар зависит от константы "NUMBER_OF_DATES" (см. [Примечания](#ПРИМЕЧАНИЯ)).

## Тесты

Для написания тестов был использован фреймворк "Jest.js".

Для данной работы было предусмотрено 5 тестов:
1. Тест "almostwholeyear.test.js". Проверяет разницу между двумя датами, когда месяцы совпадают, а год отличается на 1. (Например, даты "13-12-2020" и "9-12-2021". В таком случае разница между этими датами должна быть равна: 361 день).
2. Тест "entireyear.test.js". Проверяет разницу между двумя датами, когда отличается только год (Например, даты "18-12-2020" и "18-12-2021". В таком случае разница между этими датами должна быть равна: 366 дней — так как 2020й год является високосным).
3. Тест "newyear.test.js". Проверяет разницу между двумя датами, когда первая дата - декабрь, а вторая - январь следующего года (Например, даты "16-12-2021" и "31-1-2022". В таком случае разница между этими датами должна быть равна: 46 дней).
4. Тест "randomdate.test.js". Проверяет разницу между двумя случайно сгенерированными датами. Здесь могут возникнуть такие же особые случаи, как и у других перечисленных здесь тестов.
5. Тест "zerodays.test.js". Проверяет разницу между двумя полностью совпадающими датами (Например, даты "23-3-1974" и "23-3-1974". В таком случае разница между этими датами должна быть равна: 0 дней).

Количество выполнений каждого теста определяется значением константы "NUMBER_OF_TESTS" (см. [Примечания](#ПРИМЕЧАНИЯ)).

## Контракты для функций и классов

Для написания контрактов был использован язык разметки "JSDoc". В данной работе контракты написаны для всех функций, для класса "CustomDate" и методов этого класса. 

Пример использования контрактов представлен ниже:
```javascript
/**
 * Класс, предназначен для работы с датами и содержит методы для генерации случайной даты, проверки правильности даты и т.п.
 * @class "CustomDate"
 */
export class CustomDate {
  /**
   * Конструктор класса "CustomDate"
   * @constructor
   * @param {number} day день
   * @param {number} month месяц
   * @param {number} year год
   * @param {boolean} random параметр для генерации случайной или конкретной даты. Этот параметр надо передовать только при создании конкретной даты (и он должен быть равен "false"). По умолчанию равен "true"
   */
  constructor(day = 0, month = 0, year = 0, random = true) {
    if (random) {
      this.year = this.randYear();
      this.month = this.randMonth();
      this.day = this.randDay();
    } else {
      this.day = day;
      this.month = month;
      this.year = year;
    }

    this.adjustDateIfNeeded();
  }
```

## ПРИМЕЧАНИЯ

1. Можно запустить все тесты одновременно, используя команду:
```npm
npm run alltests
```
2. Даты выводятся в терминале в формате "ДД-ММ-ГГГГ".
3. В тестах сравниваются результаты работы методов класса "CustomDate" и результаты, полученные при помощи Date и его методов.
4. Все константы находятся в файле "/help/constants.js".
